# SPDX-License-Identifier: GPL-2.0-only OR BSD-2-Clause
%YAML 1.2
---
$id: http://devicetree.org/schemas/mfd/spacemit,p1.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: P1 of SpacemiT Power Management Integrated Circuit

maintainers:
  - Troy Mitchell <troymitchell988@gmail.com>

description:
  P1 PMIC from SpacemiT. The device consists of i2c controlled MFD,
  which contains regulator, pinctrl, pwrkey and rtc.

properties:
  compatible:
    const: spacemit,p1

  reg:
    maxItems: 1

  interrupts:
    maxItems: 1
  
  regulators:
    properties:
      compatible:
        const: pmic,regulator,p1

    type: object
    unevaluatedProperties: false
    patternProperties:
      "^(DCDC_REG[1-6]|ALDO_REG[1-4]|DLDO_REG[1-7]|SWITCH_REG1)$":
        type: object
        $ref: /schemas/regulator/regulator.yaml#
        unevaluatedProperties: false

  pinctrl:
    type: object

    properties:
      compatible:
        const: pmic,pinctrl,p1

      "#gpio-cells":
        const: 2

      gpio-controller: true

    required:
      - compatible
      - "#gpio-cells"
      - gpio-controller

    unevaluatedProperties: false

  pwrkey:
    type: object
    $ref: /schemas/input/input.yaml#
    
    properties:
      compatible:
        const: pmic,pwrkey,p1

    required:
      - compatible

    unevaluatedProperties: false

  rtc:
    type: object
    $ref: /schemas/rtc/rtc.yaml#

    properties:
      compatible:
        const: pmic,rtc,p1

    required:
      - compatible

    unevaluatedProperties: false


required:
  - compatible
  - reg
  - interrupts

unevaluatedProperties: false

examples:
  - |
    i2c {
        #address-cells = <1>;
        #size-cells = <0>;

        pmic@41 {
            compatible = "spacemit,p1";
            reg = <0x41>;
            interrupt-parent = <&intc>;
            interrupts = <64>;
            status = "okay";

            regulators {
                compatible = "pmic,regulator,p1";

                DCDC_REG1 {
                        regulator-name = "dcdc1";
                        regulator-min-microvolt = <500000>;
                        regulator-max-microvolt = <3450000>;
                        regulator-ramp-delay = <5000>;
                        regulator-always-on;
                };

                DCDC_REG2 {
                        regulator-name = "dcdc2";
                        regulator-min-microvolt = <500000>;
                        regulator-max-microvolt = <3450000>;
                        regulator-ramp-delay = <5000>;
                        regulator-always-on;
                };

                DCDC_REG3 {
                        regulator-name = "dcdc3";
                        regulator-min-microvolt = <500000>;
                        regulator-max-microvolt = <1800000>;
                        regulator-ramp-delay = <5000>;
                        regulator-always-on;
                };

                DCDC_REG4 {
                        regulator-name = "dcdc4";
                        regulator-min-microvolt = <500000>;
                        regulator-max-microvolt = <3300000>;
                        regulator-ramp-delay = <5000>;
                        regulator-always-on;
                };

                DCDC_REG5 {
                        regulator-name = "dcdc5";
                        regulator-min-microvolt = <500000>;
                        regulator-max-microvolt = <3450000>;
                        regulator-ramp-delay = <5000>;
                        regulator-always-on;
                };

                DCDC_REG6 {
                        regulator-name = "dcdc6";
                        regulator-min-microvolt = <500000>;
                        regulator-max-microvolt = <3450000>;
                        regulator-ramp-delay = <5000>;
                        regulator-always-on;
                };

                ALDO_REG1 {
                        regulator-name = "aldo1";
                        regulator-min-microvolt = <500000>;
                        regulator-max-microvolt = <3400000>;
                        regulator-boot-on;
                };

                ALDO_REG2 {
                        regulator-name = "aldo2";
                        regulator-min-microvolt = <500000>;
                        regulator-max-microvolt = <3400000>;
                };

                ALDO_REG3 {
                        regulator-name = "aldo3";
                        regulator-min-microvolt = <500000>;
                        regulator-max-microvolt = <3400000>;
                };

                ALDO_REG4 {
                        regulator-name = "aldo4";
                        regulator-min-microvolt = <500000>;
                        regulator-max-microvolt = <3400000>;
                };

                DLDO_REG1 {
                        regulator-name = "dldo1";
                        regulator-min-microvolt = <500000>;
                        regulator-max-microvolt = <3400000>;
                        regulator-boot-on;
                };

                DLDO_REG2 {
                        regulator-name = "dldo2";
                        regulator-min-microvolt = <500000>;
                        regulator-max-microvolt = <3400000>;
                };

                DLDO_REG3 {
                        regulator-name = "dldo3";
                        regulator-min-microvolt = <500000>;
                        regulator-max-microvolt = <3400000>;
                };

                DLDO_REG4 {
                        regulator-name = "dldo4";
                        regulator-min-microvolt = <500000>;
                        regulator-max-microvolt = <3400000>;
                        regulator-always-on;
                };

                DLDO_REG5 {
                        regulator-name = "dldo5";
                        regulator-min-microvolt = <500000>;
                        regulator-max-microvolt = <3400000>;
                };

                DLDO_REG6 {
                        regulator-name = "dldo6";
                        regulator-min-microvolt = <500000>;
                        regulator-max-microvolt = <3400000>;
                        regulator-always-on;
                };

                DLDO_REG7 {
                        regulator-name = "dldo7";
                        regulator-min-microvolt = <500000>;
                        regulator-max-microvolt = <3400000>;
                };

                SWITCH_REG1 {
                        regulator-name = "switch1";
                };
            };

            pinctrl {
                    compatible = "pmic,pinctrl,p1";
                    gpio-controller;
                    #gpio-cells = <2>;
            };

            pwrkey {
                compatible = "pmic,pwrkey,p1";
            };

            rtc {
                compatible = "pmic,rtc,p1";
            };
        };
    };
